<?xml version="1.0" encoding="UTF-8"?>
<document xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="https://modeler.netgrif.com/petriflow_schema.xsd">
	<id>objednavka</id>
	<initials>OBJ</initials>
	<title>Objednávka</title>
	<defaultRole>true</defaultRole>
	<transitionRole>false</transitionRole>
	<!-- TRANSACTIONS -->
	<!-- ROLES -->
	<role>
		<id>kurier</id>
		<title>Kuriér</title>
	</role>
	<role>
		<id>klient</id>
		<title>Klient</title>
	</role>
	<role>
		<id>skladnik</id>
		<title>Skladník</title>
	</role>
	<!-- DATA -->
	<data type="text">
		<id>street</id>
		<title>Ulica</title>
	</data>
	<data type="text">
		<id>street_number</id>
		<title>Súpisné číslo</title>
	</data>
	<data type="text">
		<id>city</id>
		<title>Mesto</title>
	</data>
	<data type="text">
		<id>postal_code</id>
		<title>PSČ</title>
		<valid>regex("(^\d{5}$)|(^\d\d\d \d\d$)")</valid>
	</data>
	<data type="text">
		<id>klient_caseId</id>
		<title>klient_caseId</title>
	</data>
	<data type="taskRef">
		<id>addressReadRef</id>
		<title>Fakturačná adresa</title>
	</data>
	<data type="taskRef">
		<id>contactReadRef</id>
		<title>Kontaktné údaje</title>
	</data>
	<data type="taskRef">
		<id>itemsInCartRef</id>
		<title>Košík</title>
	</data>
	<data type="text">
		<id>card_number</id>
		<title>Čislo karty</title>
		<placeholder>0000 0000 0000 0000</placeholder>
		<valid>regex("(^\d{4} \d{4} \d{4} \d{4}$)|(^\d{16}$)")</valid>
		<init>0000 0000 0000 0000</init>
	</data>
	<data type="text">
		<id>expiration_date</id>
		<title>Dátum platnosti karty</title>
		<placeholder>MM/YY</placeholder>
		<valid>regex("^(([0][1-9])|([1][0-2]))[\/]\d\d$")</valid>
		<init>01/21</init>
	</data>
	<data type="text">
		<id>cvc</id>
		<title>CVC</title>
		<placeholder>000</placeholder>
		<valid>regex("^(\d{3})$")</valid>
		<init>000</init>
	</data>
	<data type="text">
		<id>code_gen</id>
		<title>Vygenerovaný kód</title>
		<action trigger="get">
			kod: f.this;
			def ran = new java.util.Random();
			change kod value {
			"${ran.nextInt(10)}${ran.nextInt(10)}${ran.nextInt(10)}${ran.nextInt(10)}" as String
			}
		</action>
	</data>
	<data type="text">
		<id>code</id>
		<title>Kód</title>
	</data>
	<data type="number">
		<id>1001</id>
		<title>Zle</title>
		<init>0</init>
	</data>
	<data type="number">
		<id>1000</id>
		<title>Dobre</title>
		<init>0</init>
	</data>
	<data type="text">
		<id>status</id>
		<title>Stav objednávky</title>
	</data>
	<data type="text">
		<id>cancel_order_reason</id>
		<title>Dôvod zrušenia objednávky</title>
		<values>area</values>
	</data>
	<data type="boolean">
		<id>address_change_bool</id>
		<title>Adresa doručenia je rovnaká ako fakturačná</title>
		<init>true</init>
	</data>
	<data type="text">
		<id>cancel_reservation_reason</id>
		<title>Dôvod zrušenia rezervácie</title>
		<values>area</values>
	</data>
	<data type="user">
		<id>kurier</id>
		<title>Kuriér</title>
	</data>
	<data type="text">
		<id>section</id>
		<title>Oddelenie</title>
	</data>
	<data type="text">
		<id>aisle</id>
		<title>Rad</title>
	</data>
	<data type="text">
		<id>shelf</id>
		<title>Polica</title>
	</data>
	<data type="dateTime">
		<id>delivery_date</id>
		<title>Dátum doručenia</title>
	</data>
	<data type="text">
		<id>order_return_reason</id>
		<title>Dôvod vrátenia</title>
		<values>area</values>
	</data>
	<!-- I18NS -->
	<!-- TRANSITIONS -->
	<transition>
		<id>2</id>
		<x>140</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Vytvoriť novú objednávku / Klient</label>
		<icon>add_shopping_cart</icon>
		<assignPolicy>auto</assignPolicy>
		<finishPolicy>auto_no_data</finishPolicy>
		<dataGroup>
			<id>DataGroup_4</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>klient_caseId</id>
				<logic>
					<behavior>hidden</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>contactReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>addressReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>itemsInCartRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_3</id>
			<title>Zmena fakturačnej adresy</title>
			<dataRef>
				<id>address_change_bool</id>
				<logic>
					<behavior>editable</behavior>
					<action trigger="set">
						rovnaka: f.address_change_bool,
						uloha: t.2,
						street: f.street,
						cislo: f.street_number,
						mesto: f.city,
						psc: f.postal_code;

						if (rovnaka.value) {
							make street,hidden on uloha when { true }
							make cislo,hidden on uloha when { true }
							make mesto,hidden on uloha when { true }
							make psc,hidden on uloha when { true }
						} else {
							make street,editable on uloha when { true }
							make street,required on uloha when { true }
							make cislo,editable on uloha when { true }
							make mesto,editable on uloha when { true }
							make mesto,required on uloha when { true }
							make psc,editable on uloha when { true }
							make psc,required on uloha when { true }
						}
					</action>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance></appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>street</id>
				<logic>
					<behavior>hidden</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>3</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>street_number</id>
				<logic>
					<behavior>hidden</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>3</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>city</id>
				<logic>
					<behavior>hidden</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>4</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>postal_code</id>
				<logic>
					<behavior>hidden</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>4</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="assign">
			<id>2_assign</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Vytvorená"}
				</action>
			</actions>
		</event>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
				uloha: t.5,
				adresaRef: f.addressReadRef,
				rovnaka: f.address_change_bool,
				street: f.street,
				cislo: f.street_number,
				mesto: f.city,
				psc: f.postal_code;


				if (rovnaka.value == false) {
					def groupId = findCase{it.processIdentifier.eq("org_group").and(it.author.id.eq(loggedUser().id))}?.stringId
					def adresa = createCase("${groupId}_adresa", "Adresa")
					def konstruktor = assignTask("2", adresa)
					setData(konstruktor, [
						"street_name":   [ "value": street.value, "type": "text" ],
						"street_number": [ "value": cislo.value, "type": "text" ],
						"city":          [ "value": mesto.value, "type": "text" ],
						"postal_code":   [ "value": psc.value,   "type": "text" ],
					])
					finishTask(konstruktor)

					def detail = findTask{it.caseId.eq(adresa._id as String).and(it.transitionId.eq("4"))}
					change adresaRef value {
						[detail.stringId]
					}
					make adresaRef,visible on uloha when { true }
				}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>5</id>
		<x>140</x>
		<y>20</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Detail</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_4</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>contactReadRef</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>addressReadRef</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>itemsInCartRef</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>
	<transition>
		<id>27</id>
		<x>1100</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Rezervovať / Kurier</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_4</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>contactReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>addressReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>itemsInCartRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>27_finish</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Rezervovaná kuriérom"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>43</id>
		<x>1620</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Doručiť / Kurier</label>
		<icon>local_shipping</icon>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_4</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>contactReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>addressReadRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_2</id>
			<dataRef>
				<id>itemsInCartRef</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>43_finish</id>
			<actions phase="pre">
				<action>
					datum: f.delivery_date,
					status:f.status;
					change status value{"Doručená"}
					change datum value { java.time.LocalDateTime.now().plusHours(1) }
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>44</id>
		<x>1540</x>
		<y>380</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Vrátiť / Kurier</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>order_return_reason</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>2</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Vrátená"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>49</id>
		<x>260</x>
		<y>340</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zrušiť / Klient</label>
		<icon>cancel</icon>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>cancel_order_reason</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>2</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
					status:f.status,
					itemsInCartRef:f.itemsInCartRef;
					change status value {"Zrušená"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>65</id>
		<x>1340</x>
		<y>340</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zrušiť rezerváciu / Kurier</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>cancel_reservation_reason</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>2</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Zaplatená"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>71</id>
		<x>1460</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Vyzdvihnúť / Kurier</label>
		<icon>local_shipping</icon>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>section</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>aisle</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>shelf</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>1</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Prevzatá na doručenie"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>82</id>
		<x>1780</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Doručená</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>delivery_date</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>
	<transition>
		<id>84</id>
		<x>1260</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Naskladniť / Skladník</label>
		<assignPolicy>auto</assignPolicy>
		<icon>archive</icon>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>section</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>aisle</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>shelf</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>2</x>
					<y>1</y>
					<rows>1</rows>
					<cols>2</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>2_finish</id>
			<actions phase="pre">
				<action>
					status:f.status;
					change status value{"Pripravená na doručenie"}
				</action>
			</actions>
		</event>
	</transition>

	<!-- platba -->
	<transition>
		<id>96</id>
		<x>380</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zadať kartu</label>
		<icon>payment</icon>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>status</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<dataGroup>
			<id>DataGroup_1</id>
			<dataRef>
				<id>card_number</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>expiration_date</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>cvc</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>NaN</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="assign">
			<id>96_assign</id>
			<actions phase="post">
				<action>
					status:f.status;
					change status value{"Čakajúca na zaplatenie"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>99</id>
		<x>540</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Poslanie kódu smskou</label>
		<icon>phone_iphone</icon>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>code_gen</id>
				<logic>
					<behavior>editable</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
	</transition>
	<transition>
		<id>100</id>
		<x>540</x>
		<y>100</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Opätovné vygenerovanie kódu</label>
		<icon>refresh</icon>
		<assignPolicy>auto</assignPolicy>
		<finishPolicy>auto_no_data</finishPolicy>
	</transition>
	<transition>
		<id>102</id>
		<x>700</x>
		<y>180</y>
		<layout>
			<offset>0</offset>
		</layout>
		<label>Zadať kód</label>
		<assignPolicy>auto</assignPolicy>
		<dataGroup>
			<id>DataGroup_0</id>
			<dataRef>
				<id>expiration_date</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>1</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>card_number</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>0</y>
					<rows>1</rows>
					<cols>4</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>cvc</id>
				<logic>
					<behavior>visible</behavior>
				</logic>
				<layout>
					<x>0</x>
					<y>2</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
			<dataRef>
				<id>code</id>
				<logic>
					<behavior>editable</behavior>
					<behavior>required</behavior>
				</logic>
				<layout>
					<x>1</x>
					<y>2</y>
					<rows>1</rows>
					<cols>1</cols>
					<offset>0</offset>
					<template>material</template>
					<appearance>outline</appearance>
				</layout>
			</dataRef>
		</dataGroup>
		<event type="finish">
			<id>7_finish</id>
			<actions phase="pre">
				<action>
					status: f.status,
					vygenerovanyKod: f.code_gen,
					kod: f.code,
					kod_dobry: f.1000,
					kod_zly: f.1001;
					if (kod.value == vygenerovanyKod.value){
						change kod_dobry value {1}
						change kod_zly value {0}
						change status value {"Zaplatená"}
					} else {
						change kod_dobry value {0}
						change kod_zly value {1}
					}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>133</id>
		<x>460</x>
		<y>300</y>
		<layout>
			<offset>0</offset>
		</layout>
		<assignPolicy>auto</assignPolicy>
		<label>Skúsiť znova</label>
		<icon>refresh</icon>
	</transition>
	<transition>
		<id>136</id>
		<x>700</x>
		<y>460</y>
		<layout>
			<offset>0</offset>
		</layout>
		<assignPolicy>auto</assignPolicy>
		<finishPolicy>auto_no_data</finishPolicy>
		<label>3 nesprávne pokusy</label>
		<icon>clear</icon>
		<event type="assign">
			<id>136_assign</id>
			<actions phase="post">
				<action>
					status:f.status,
					itemsInCartRef: f.itemsInCartRef;
					change status value{"Zrušená"}
				</action>
			</actions>
		</event>
	</transition>
	<transition>
		<id>161</id>
		<x>540</x>
		<y>20</y>
		<layout>
			<offset>0</offset>
		</layout>
		<assignPolicy>auto</assignPolicy>
		<finishPolicy>auto_no_data</finishPolicy>
		<label>Expirácia kódu</label>
		<icon>timer</icon>
		<trigger type="time">
			<delay>PT60S</delay>
		</trigger>
	</transition>
	<!-- PLACES -->
	<place>
		<id>1</id>
		<x>60</x>
		<y>180</y>
		<label></label>
		<tokens>1</tokens>
		<static>false</static>
	</place>
	<place>
		<id>4</id>
		<x>260</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>32</id>
		<x>1700</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>39</id>
		<x>260</x>
		<y>460</y>
		<label>Objednávka zrušená</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>68</id>
		<x>1180</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>73</id>
		<x>1540</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>77</id>
		<x>140</x>
		<y>100</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>85</id>
		<x>1340</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>89</id>
		<x>1380</x>
		<y>100</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>98</id>
		<x>460</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>101</id>
		<x>620</x>
		<y>180</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>106</id>
		<x>940</x>
		<y>180</y>
		<label>Objednávka zaplatená</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>139</id>
		<x>820</x>
		<y>300</y>
		<label>Count</label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<place>
		<id>147</id>
		<x>700</x>
		<y>300</y>
		<label></label>
		<tokens>0</tokens>
		<static>false</static>
	</place>
	<!-- ARCS -->
	<arc>
		<id>9</id>
		<type>regular</type>
		<sourceId>1</sourceId>
		<destinationId>2</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>11</id>
		<type>regular</type>
		<sourceId>2</sourceId>
		<destinationId>4</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>46</id>
		<type>regular</type>
		<sourceId>43</sourceId>
		<destinationId>32</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>52</id>
		<type>regular</type>
		<sourceId>49</sourceId>
		<destinationId>39</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>64</id>
		<type>regular</type>
		<sourceId>4</sourceId>
		<destinationId>49</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>69</id>
		<type>regular</type>
		<sourceId>27</sourceId>
		<destinationId>68</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>74</id>
		<type>regular</type>
		<sourceId>71</sourceId>
		<destinationId>73</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>75</id>
		<type>regular</type>
		<sourceId>73</sourceId>
		<destinationId>43</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>76</id>
		<type>regular</type>
		<sourceId>73</sourceId>
		<destinationId>44</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>78</id>
		<type>regular</type>
		<sourceId>2</sourceId>
		<destinationId>77</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>79</id>
		<type>read</type>
		<sourceId>77</sourceId>
		<destinationId>5</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>83</id>
		<type>read</type>
		<sourceId>32</sourceId>
		<destinationId>82</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>86</id>
		<type>regular</type>
		<sourceId>68</sourceId>
		<destinationId>84</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>87</id>
		<type>regular</type>
		<sourceId>84</sourceId>
		<destinationId>85</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>88</id>
		<type>regular</type>
		<sourceId>85</sourceId>
		<destinationId>71</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>90</id>
		<type>regular</type>
		<sourceId>27</sourceId>
		<destinationId>89</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>1100</x><y>100</y></breakPoint>
	</arc>
	<arc>
		<id>91</id>
		<type>regular</type>
		<sourceId>89</sourceId>
		<destinationId>65</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>1380</x><y>340</y></breakPoint>
	</arc>
	<arc>
		<id>92</id>
		<type>regular</type>
		<sourceId>89</sourceId>
		<destinationId>71</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>1460</x><y>100</y></breakPoint>
	</arc>
	<arc>
		<id>93</id>
		<type>reset</type>
		<sourceId>68</sourceId>
		<destinationId>65</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>1180</x><y>260</y></breakPoint>
		<breakPoint><x>1340</x><y>260</y></breakPoint>
	</arc>
	<arc>
		<id>94</id>
		<type>reset</type>
		<sourceId>85</sourceId>
		<destinationId>65</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>109</id>
		<type>regular</type>
		<sourceId>4</sourceId>
		<destinationId>96</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>110</id>
		<type>regular</type>
		<sourceId>96</sourceId>
		<destinationId>98</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>111</id>
		<type>regular</type>
		<sourceId>98</sourceId>
		<destinationId>99</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>112</id>
		<type>regular</type>
		<sourceId>99</sourceId>
		<destinationId>101</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>113</id>
		<type>regular</type>
		<sourceId>101</sourceId>
		<destinationId>100</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>620</x><y>100</y></breakPoint>
	</arc>
	<arc>
		<id>114</id>
		<type>regular</type>
		<sourceId>100</sourceId>
		<destinationId>98</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>460</x><y>100</y></breakPoint>
	</arc>
	<arc>
		<id>115</id>
		<type>regular</type>
		<sourceId>101</sourceId>
		<destinationId>102</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>117</id>
		<type>variable</type>
		<sourceId>102</sourceId>
		<destinationId>106</destinationId>
		<multiplicity>1000</multiplicity>
	</arc>
	<arc>
		<id>138</id>
		<type>regular</type>
		<sourceId>136</sourceId>
		<destinationId>39</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>141</id>
		<type>regular</type>
		<sourceId>139</sourceId>
		<destinationId>136</destinationId>
		<multiplicity>3</multiplicity>
		<breakPoint><x>820</x><y>460</y></breakPoint>
	</arc>
	<arc>
		<id>143</id>
		<type>inhibitor</type>
		<sourceId>139</sourceId>
		<destinationId>133</destinationId>
		<multiplicity>3</multiplicity>
		<breakPoint><x>820</x><y>380</y></breakPoint>
		<breakPoint><x>460</x><y>380</y></breakPoint>
	</arc>
	<arc>
		<id>150</id>
		<type>reset</type>
		<sourceId>147</sourceId>
		<destinationId>136</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>155</id>
		<type>variable</type>
		<sourceId>102</sourceId>
		<destinationId>139</destinationId>
		<multiplicity>1001</multiplicity>
		<breakPoint><x>820</x><y>220</y></breakPoint>
	</arc>
	<arc>
		<id>156</id>
		<type>variable</type>
		<sourceId>102</sourceId>
		<destinationId>147</destinationId>
		<multiplicity>1001</multiplicity>
	</arc>
	<arc>
		<id>157</id>
		<type>regular</type>
		<sourceId>133</sourceId>
		<destinationId>98</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>160</id>
		<type>regular</type>
		<sourceId>147</sourceId>
		<destinationId>133</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>162</id>
		<type>regular</type>
		<sourceId>101</sourceId>
		<destinationId>161</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>620</x><y>20</y></breakPoint>
	</arc>
	<arc>
		<id>164</id>
		<type>regular</type>
		<sourceId>161</sourceId>
		<destinationId>98</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>460</x><y>20</y></breakPoint>
	</arc>
	<arc>
		<id>165</id>
		<type>regular</type>
		<sourceId>106</sourceId>
		<destinationId>27</destinationId>
		<multiplicity>1</multiplicity>
	</arc>
	<arc>
		<id>166</id>
		<type>regular</type>
		<sourceId>65</sourceId>
		<destinationId>106</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>940</x><y>340</y></breakPoint>
	</arc>
	<arc>
		<id>167</id>
		<type>regular</type>
		<sourceId>44</sourceId>
		<destinationId>106</destinationId>
		<multiplicity>1</multiplicity>
		<breakPoint><x>940</x><y>380</y></breakPoint>
	</arc>
</document>
